<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logging & Incident Response - Iron Codex</title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <meta name="description" content="Comprehensive incident response guide with 25 controls for SIEM, logging, threat detection, and response procedures">
</head>
<body data-page="guide">
    <header class="header">
        <nav class="nav container">
            <a href="../index.html" class="logo" aria-label="Iron Codex home">
                <img src="../assets/img/iron-book-logo.svg" alt="Iron Codex" class="logo-icon">
                <span class="logo-text">Iron Codex Cybersecurity</span>
            </a>
            <ul class="nav-menu">
                <li><a href="../index.html" class="nav-link">Home</a></li>
                <li><a href="../topics.html" class="nav-link">Topics</a></li>
                <li><a href="../guides.html" class="nav-link">Guides</a></li>
                <li><a href="../tools.html" class="nav-link">Tools</a></li>
                <li><a href="../about.html" class="nav-link">About</a></li>
            </ul>
            <div class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <main class="container guide-content">
        <section class="guide-header">
            <nav class="breadcrumb">
                <a href="../guides.html">Guides</a> / <span>Logging & Incident Response</span>
            </nav>
            <h1>Logging & Incident Response</h1>
            <div class="guide-meta">
                <span class="meta-item">25 Controls</span>
                <span class="meta-item">Intermediate Level</span>
                <span class="meta-item">Last Updated: December 2024</span>
            </div>
            <p class="guide-intro">SIEM deployment, log management, threat detection, incident response procedures, and forensic analysis with practical playbooks and automation.</p>
        </section>

        <section class="toc-section">
            <h2>Table of Contents</h2>
            <div class="toc-grid">
                <div class="toc-column">
                    <ul class="toc-list">
                        <li><a href="#logging-framework">1. Logging Framework (7 controls)</a></li>
                        <li><a href="#siem-deployment">2. SIEM Deployment (6 controls)</a></li>
                        <li><a href="#threat-detection">3. Threat Detection (5 controls)</a></li>
                    </ul>
                </div>
                <div class="toc-column">
                    <ul class="toc-list">
                        <li><a href="#incident-response">4. Incident Response (4 controls)</a></li>
                        <li><a href="#forensics">5. Digital Forensics (2 controls)</a></li>
                        <li><a href="#automation">6. Response Automation (1 control)</a></li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="logging-framework" class="control-section">
            <h2>1. Logging Framework (7 controls)</h2>
            <p class="section-intro">Establish comprehensive logging infrastructure with proper collection, storage, and retention policies.</p>

            <div class="control-card">
                <h3>Implement Centralized Log Management</h3>
                <div class="control-tags">
                    <span class="tag priority-critical">Critical</span>
                    <span class="tag difficulty-medium">Medium Difficulty</span>
                </div>
                <p><strong>Requirement:</strong> Deploy centralized logging system to collect, aggregate, and store logs from all systems.</p>
                <div class="implementation">
                    <h4>Implementation Example:</h4>
                    <pre><code># ELK Stack Docker Compose Configuration
version: '3.8'
services:
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.0
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=true
      - ELASTIC_PASSWORD=changeme
      - "ES_JAVA_OPTS=-Xms2g -Xmx2g"
    volumes:
      - elasticsearch-data:/usr/share/elasticsearch/data
    ports:
      - "9200:9200"
    networks:
      - elk

  logstash:
    image: docker.elastic.co/logstash/logstash:8.11.0
    volumes:
      - ./logstash/config/logstash.yml:/usr/share/logstash/config/logstash.yml
      - ./logstash/pipeline:/usr/share/logstash/pipeline
    ports:
      - "5044:5044"
      - "9600:9600"
    environment:
      LS_JAVA_OPTS: "-Xmx1g -Xms1g"
    networks:
      - elk
    depends_on:
      - elasticsearch

  kibana:
    image: docker.elastic.co/kibana/kibana:8.11.0
    ports:
      - "5601:5601"
    environment:
      - ELASTICSEARCH_HOSTS=http://elasticsearch:9200
      - ELASTICSEARCH_USERNAME=elastic
      - ELASTICSEARCH_PASSWORD=changeme
    networks:
      - elk
    depends_on:
      - elasticsearch

networks:
  elk:
    driver: bridge

volumes:
  elasticsearch-data:
    driver: local

# Logstash Pipeline Configuration
input {
  beats {
    port => 5044
  }
  
  syslog {
    port => 5514
  }
  
  http {
    port => 8080
  }
}

filter {
  if [fields][log_type] == "security" {
    mutate {
      add_tag => ["security_event"]
    }
  }
  
  # Parse common log formats
  if [message] =~ /^\d{4}-\d{2}-\d{2}/ {
    grok {
      match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:level} %{GREEDYDATA:log_message}" }
    }
    
    date {
      match => [ "timestamp", "yyyy-MM-dd HH:mm:ss.SSS" ]
    }
  }
  
  # GeoIP enrichment for IP addresses
  if [client_ip] {
    geoip {
      source => "client_ip"
      target => "geoip"
    }
  }
}

output {
  elasticsearch {
    hosts => ["elasticsearch:9200"]
    user => "elastic"
    password => "changeme"
    index => "logs-%{+YYYY.MM.dd}"
  }
}</code></pre>
                </div>
                <div class="validation">
                    <h4>Validation:</h4>
                    <ul>
                        <li>Verify log ingestion from all sources</li>
                        <li>Test log parsing and field extraction</li>
                        <li>Validate retention policies and storage</li>
                        <li>Check dashboard functionality and alerting</li>
                    </ul>
                </div>
            </div>

            <div class="control-card">
                <h3>Configure Security Event Logging</h3>
                <div class="control-tags">
                    <span class="tag priority-high">High Priority</span>
                    <span class="tag difficulty-medium">Medium Difficulty</span>
                </div>
                <p><strong>Requirement:</strong> Log all security-relevant events with appropriate detail and context.</p>
                <div class="implementation">
                    <h4>Implementation Example:</h4>
                    <pre><code># Application Security Logging (Python)
import logging
import json
from datetime import datetime
from flask import request, g

class SecurityLogger:
    def __init__(self):
        self.logger = logging.getLogger('security')
        handler = logging.StreamHandler()
        formatter = logging.Formatter(
            '%(asctime)s - SECURITY - %(levelname)s - %(message)s'
        )
        handler.setFormatter(formatter)
        self.logger.addHandler(handler)
        self.logger.setLevel(logging.INFO)
    
    def log_authentication_event(self, user_id, event_type, success, details=None):
        event = {
            'event_type': 'authentication',
            'sub_type': event_type,
            'user_id': user_id,
            'success': success,
            'timestamp': datetime.utcnow().isoformat(),
            'source_ip': request.remote_addr if request else None,
            'user_agent': request.headers.get('User-Agent') if request else None,
            'details': details or {}
        }
        
        level = logging.INFO if success else logging.WARNING
        self.logger.log(level, json.dumps(event))
    
    def log_authorization_failure(self, user_id, resource, action, reason):
        event = {
            'event_type': 'authorization_failure',
            'user_id': user_id,
            'resource': resource,
            'action': action,
            'reason': reason,
            'timestamp': datetime.utcnow().isoformat(),
            'source_ip': request.remote_addr if request else None
        }
        
        self.logger.warning(json.dumps(event))
    
    def log_suspicious_activity(self, event_type, severity, description, context=None):
        event = {
            'event_type': 'suspicious_activity',
            'sub_type': event_type,
            'severity': severity,
            'description': description,
            'context': context or {},
            'timestamp': datetime.utcnow().isoformat(),
            'source_ip': request.remote_addr if request else None
        }
        
        self.logger.error(json.dumps(event))

# Usage in application
security_logger = SecurityLogger()

@app.route('/login', methods=['POST'])
def login():
    username = request.form.get('username')
    password = request.form.get('password')
    
    user = authenticate_user(username, password)
    if user:
        security_logger.log_authentication_event(
            user.id, 'login', True, {'method': 'password'}
        )
        return jsonify({'status': 'success'})
    else:
        security_logger.log_authentication_event(
            username, 'login', False, {'method': 'password', 'reason': 'invalid_credentials'}
        )
        return jsonify({'error': 'Invalid credentials'}), 401</code></pre>
                </div>
                <div class="best-practices">
                    <h4>Best Practices:</h4>
                    <ul>
                        <li>Log authentication and authorization events</li>
                        <li>Include contextual information (IP, user agent, timestamp)</li>
                        <li>Use structured logging formats (JSON)</li>
                        <li>Implement consistent event categorization</li>
                    </ul>
                </div>
            </div>

            <div class="control-card">
                <h3>Implement Log Integrity Protection</h3>
                <div class="control-tags">
                    <span class="tag priority-high">High Priority</span>
                    <span class="tag difficulty-high">High Difficulty</span>
                </div>
                <p><strong>Requirement:</strong> Protect log integrity using cryptographic methods and tamper detection.</p>
                <div class="implementation">
                    <h4>Implementation Example:</h4>
                    <pre><code># Log Integrity Protection (Python)
import hashlib
import hmac
import json
from cryptography.fernet import Fernet
from datetime import datetime

class SecureLogger:
    def __init__(self, integrity_key, encryption_key=None):
        self.integrity_key = integrity_key.encode() if isinstance(integrity_key, str) else integrity_key
        self.encryption_key = encryption_key
        self.fernet = Fernet(encryption_key) if encryption_key else None
        self.previous_hash = None
    
    def create_log_entry(self, message, level='INFO'):
        timestamp = datetime.utcnow().isoformat()
        entry = {
            'timestamp': timestamp,
            'level': level,
            'message': message,
            'previous_hash': self.previous_hash
        }
        
        # Create integrity hash
        entry_string = json.dumps(entry, sort_keys=True)
        integrity_hash = hmac.new(
            self.integrity_key, 
            entry_string.encode(), 
            hashlib.sha256
        ).hexdigest()
        
        entry['integrity_hash'] = integrity_hash
        self.previous_hash = integrity_hash
        
        # Encrypt if encryption key provided
        if self.fernet:
            encrypted_entry = self.fernet.encrypt(json.dumps(entry).encode())
            return encrypted_entry
        
        return json.dumps(entry)
    
    def verify_log_chain(self, log_entries):
        """Verify the integrity of a chain of log entries"""
        previous_hash = None
        
        for i, entry in enumerate(log_entries):
            if isinstance(entry, bytes):
                # Decrypt if encrypted
                entry = json.loads(self.fernet.decrypt(entry).decode())
            elif isinstance(entry, str):
                entry = json.loads(entry)
            
            # Verify previous hash link
            if entry['previous_hash'] != previous_hash:
                return False, f"Hash chain broken at entry {i}"
            
            # Verify integrity hash
            temp_entry = entry.copy()
            stored_hash = temp_entry.pop('integrity_hash')
            
            calculated_hash = hmac.new(
                self.integrity_key,
                json.dumps(temp_entry, sort_keys=True).encode(),
                hashlib.sha256
            ).hexdigest()
            
            if calculated_hash != stored_hash:
                return False, f"Integrity hash mismatch at entry {i}"
            
            previous_hash = stored_hash
        
        return True, "Log chain integrity verified"

# Usage
logger = SecureLogger(
    integrity_key="your-secret-integrity-key",
    encryption_key=Fernet.generate_key()
)

# Create secure log entries
entry1 = logger.create_log_entry("User login attempt", "INFO")
entry2 = logger.create_log_entry("Failed authentication", "WARN")

# Verify log integrity
entries = [entry1, entry2]
is_valid, message = logger.verify_log_chain(entries)</code></pre>
                </div>
                <div class="security-notes">
                    <h4>Security Considerations:</h4>
                    <ul>
                        <li>Use hardware security modules (HSMs) for key storage</li>
                        <li>Implement log forwarding to immutable storage</li>
                        <li>Regular integrity checks and alerting</li>
                        <li>Separate log infrastructure from production systems</li>
                    </ul>
                </div>
            </div>

            <div class="control-summary">
                <h4>Additional Logging Framework Controls:</h4>
                <div class="summary-grid">
                    <div class="summary-item">
                        <strong>Log Retention Policies:</strong> Automated retention and archival based on compliance requirements
                    </div>
                    <div class="summary-item">
                        <strong>Log Format Standardization:</strong> Consistent structured logging across all systems
                    </div>
                    <div class="summary-item">
                        <strong>Log Monitoring and Alerting:</strong> Real-time monitoring for log ingestion issues
                    </div>
                    <div class="summary-item">
                        <strong>Performance Optimization:</strong> Efficient log processing and storage management
                    </div>
                </div>
            </div>
        </section>

        <section id="siem-deployment" class="control-section">
            <h2>2. SIEM Deployment (6 controls)</h2>
            <p class="section-intro">Deploy and configure SIEM solutions for comprehensive security monitoring and analysis.</p>

            <div class="control-card">
                <h3>Configure SIEM Rules and Correlation</h3>
                <div class="control-tags">
                    <span class="tag priority-critical">Critical</span>
                    <span class="tag difficulty-high">High Difficulty</span>
                </div>
                <p><strong>Requirement:</strong> Implement correlation rules to detect security events and attack patterns.</p>
                <div class="implementation">
                    <h4>Implementation Example:</h4>
                    <pre><code># Elasticsearch Watcher Rules for Security Events
# Brute Force Detection
PUT _watcher/watch/brute_force_detection
{
  "trigger": {
    "schedule": {
      "interval": "5m"
    }
  },
  "input": {
    "search": {
      "request": {
        "search_type": "query_then_fetch",
        "indices": ["logs-*"],
        "body": {
          "query": {
            "bool": {
              "must": [
                {
                  "match": {
                    "event_type": "authentication"
                  }
                },
                {
                  "match": {
                    "success": false
                  }
                },
                {
                  "range": {
                    "@timestamp": {
                      "gte": "now-5m"
                    }
                  }
                }
              ]
            }
          },
          "aggs": {
            "failed_attempts": {
              "terms": {
                "field": "source_ip.keyword",
                "min_doc_count": 5
              }
            }
          }
        }
      }
    }
  },
  "condition": {
    "compare": {
      "ctx.payload.aggregations.failed_attempts.buckets.0.doc_count": {
        "gt": 5
      }
    }
  },
  "actions": {
    "send_alert": {
      "webhook": {
        "scheme": "https",
        "host": "alerts.company.com",
        "port": 443,
        "method": "POST",
        "path": "/webhook/security",
        "params": {},
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{\"alert_type\": \"brute_force\", \"source_ip\": \"{{ctx.payload.aggregations.failed_attempts.buckets.0.key}}\", \"attempts\": \"{{ctx.payload.aggregations.failed_attempts.buckets.0.doc_count}}\"}"
      }
    }
  }
}

# Suspicious Login Pattern Detection
PUT _watcher/watch/suspicious_login_pattern
{
  "trigger": {
    "schedule": {
      "interval": "10m"
    }
  },
  "input": {
    "search": {
      "request": {
        "indices": ["logs-*"],
        "body": {
          "query": {
            "bool": {
              "must": [
                {
                  "match": {
                    "event_type": "authentication"
                  }
                },
                {
                  "match": {
                    "success": true
                  }
                },
                {
                  "range": {
                    "@timestamp": {
                      "gte": "now-10m"
                    }
                  }
                }
              ]
            }
          },
          "aggs": {
            "users": {
              "terms": {
                "field": "user_id.keyword"
              },
              "aggs": {
                "unique_ips": {
                  "cardinality": {
                    "field": "source_ip.keyword"
                  }
                },
                "unique_locations": {
                  "cardinality": {
                    "field": "geoip.country_code2.keyword"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "condition": {
    "script": {
      "source": "ctx.payload.aggregations.users.buckets.stream().anyMatch(bucket -> bucket.unique_ips.value > 3 || bucket.unique_locations.value > 2)"
    }
  },
  "actions": {
    "send_alert": {
      "email": {
        "to": ["security@company.com"],
        "subject": "Suspicious Login Pattern Detected",
        "body": "Multiple geographic locations or IP addresses detected for user logins in the last 10 minutes."
      }
    }
  }
}</code></pre>
                </div>
            </div>

            <div class="control-summary">
                <h4>Additional SIEM Deployment Controls:</h4>
                <div class="summary-grid">
                    <div class="summary-item">
                        <strong>Data Source Integration:</strong> Connect all security-relevant data sources
                    </div>
                    <div class="summary-item">
                        <strong>Dashboard Creation:</strong> Security operations center dashboards and visualizations
                    </div>
                    <div class="summary-item">
                        <strong>Alert Management:</strong> Proper alert prioritization and escalation procedures
                    </div>
                    <div class="summary-item">
                        <strong>SIEM Maintenance:</strong> Regular rule updates and performance tuning
                    </div>
                    <div class="summary-item">
                        <strong>User Training:</strong> SOC analyst training on SIEM tools and procedures
                    </div>
                </div>
            </div>
        </section>

        <section class="remaining-sections">
            <h2>Remaining Sections</h2>
            <div class="section-preview">
                <div class="preview-card" id="threat-detection">
                    <h3>3. Threat Detection (5 controls)</h3>
                    <p>Advanced threat detection and behavioral analysis.</p>
                    <ul class="preview-controls">
                        <li>Behavioral Analytics Implementation</li>
                        <li>Threat Intelligence Integration</li>
                        <li>Machine Learning Detection Models</li>
                        <li>Anomaly Detection Systems</li>
                        <li>Threat Hunting Procedures</li>
                    </ul>
                </div>

                <div class="preview-card" id="incident-response">
                    <h3>4. Incident Response (4 controls)</h3>
                    <p>Structured incident response procedures and playbooks.</p>
                    <ul class="preview-controls">
                        <li>Incident Response Plan Development</li>
                        <li>Response Team Organization</li>
                        <li>Communication Procedures</li>
                        <li>Post-Incident Analysis</li>
                    </ul>
                </div>

                <div class="preview-card" id="forensics">
                    <h3>5. Digital Forensics (2 controls)</h3>
                    <p>Forensic investigation capabilities and evidence handling.</p>
                    <ul class="preview-controls">
                        <li>Forensic Investigation Procedures</li>
                        <li>Evidence Collection and Chain of Custody</li>
                    </ul>
                </div>

                <div class="preview-card" id="automation">
                    <h3>6. Response Automation (1 control)</h3>
                    <p>Automated response and orchestration capabilities.</p>
                    <ul class="preview-controls">
                        <li>Security Orchestration and Automated Response (SOAR)</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="guide-footer">
            <div class="footer-nav">
                <a href="../guides.html" class="btn btn-outline">‚Üê Back to Guides</a>
                <a href="#" onclick="downloadGuide()" class="btn btn-primary">Download PDF</a>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 Iron Codex. Open source cybersecurity education.</p>
            </div>
        </div>
    </footer>

    <script src="../assets/js/main.js"></script>
    <script>
        function downloadGuide() {
            alert('PDF download feature coming soon! For now, you can bookmark this page or print to PDF using your browser.');
        }

        document.querySelectorAll('.toc-list a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>

    <style>
        .guide-content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .guide-header {
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--border);
        }

        .breadcrumb {
            color: var(--text-muted);
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .breadcrumb a {
            color: var(--accent);
        }

        .guide-header h1 {
            font-size: 3rem;
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .guide-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .meta-item {
            background: var(--glass);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--text-muted);
            border: 1px solid var(--border);
        }

        .guide-intro {
            font-size: 1.2rem;
            color: var(--text-muted);
            line-height: 1.6;
        }

        .toc-section {
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 3rem;
        }

        .toc-section h2 {
            color: var(--accent);
            margin-bottom: 1.5rem;
        }

        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list li {
            margin-bottom: 0.5rem;
        }

        .toc-list a {
            color: var(--text);
            text-decoration: none;
            padding: 0.5rem;
            display: block;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .toc-list a:hover {
            background: var(--glass);
            color: var(--accent);
        }

        .control-section {
            margin-bottom: 4rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .control-section h2 {
            color: var(--accent);
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .section-intro {
            color: var(--text-muted);
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .control-card {
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .control-card h3 {
            color: var(--accent);
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }

        .control-tags {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .tag {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .priority-critical {
            background: rgba(255, 71, 87, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .priority-high {
            background: rgba(255, 167, 38, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .difficulty-medium {
            background: rgba(255, 167, 38, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .difficulty-high {
            background: rgba(255, 71, 87, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .implementation,
        .validation,
        .best-practices,
        .security-notes {
            margin: 1.5rem 0;
        }

        .implementation h4,
        .validation h4,
        .best-practices h4,
        .security-notes h4 {
            color: var(--success);
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        pre {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        code {
            color: var(--accent);
            font-family: 'Courier New', monospace;
        }

        .control-summary {
            background: rgba(0, 212, 255, 0.05);
            border: 1px solid var(--accent);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .summary-item {
            background: var(--glass);
            padding: 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .remaining-sections {
            margin: 4rem 0;
        }

        .section-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .preview-card {
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
        }

        .preview-card h3 {
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .preview-controls {
            list-style: none;
            margin-top: 1rem;
        }

        .preview-controls li {
            color: var(--text-muted);
            padding: 0.3rem 0;
            font-size: 0.9rem;
        }

        .guide-footer {
            text-align: center;
            padding: 3rem 0;
            margin-top: 4rem;
            border-top: 2px solid var(--border);
        }

        .footer-nav {
            display: flex;
            gap: 2rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .guide-header h1 {
                font-size: 2rem;
            }
            
            .guide-meta {
                flex-direction: column;
                gap: 1rem;
            }
            
            .toc-grid,
            .summary-grid,
            .section-preview {
                grid-template-columns: 1fr;
            }
            
            .footer-nav {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</body>
</html>