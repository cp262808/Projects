<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Security Expanded - Iron Codex</title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <meta name="description" content="Comprehensive API security guide with 74 practical controls for REST, GraphQL, authentication, and more">
</head>
<body data-page="guide">
    <header class="header">
        <nav class="nav container">
            <a href="../index.html" class="logo">üõ°Ô∏è Iron Codex</a>
            <ul class="nav-menu">
                <li><a href="../index.html" class="nav-link">Home</a></li>
                <li><a href="../topics.html" class="nav-link">Topics</a></li>
                <li><a href="../guides.html" class="nav-link">Guides</a></li>
                <li><a href="../tools.html" class="nav-link">Tools</a></li>
                <li><a href="../about.html" class="nav-link">About</a></li>
            </ul>
            <div class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <main class="container guide-content">
        <!-- Guide Header -->
        <section class="guide-header">
            <nav class="breadcrumb">
                <a href="../guides.html">Guides</a> / <span>API Security Expanded</span>
            </nav>
            <h1>API Security Expanded</h1>
            <div class="guide-meta">
                <span class="meta-item">74 Controls</span>
                <span class="meta-item">Expert Level</span>
                <span class="meta-item">Last Updated: December 2024</span>
            </div>
            <p class="guide-intro">Complete API security framework covering REST, GraphQL, authentication, authorization, rate limiting, and API gateway configuration with practical implementation examples.</p>
        </section>

        <!-- Table of Contents -->
        <section class="toc-section">
            <h2>Table of Contents</h2>
            <div class="toc-grid">
                <div class="toc-column">
                    <ul class="toc-list">
                        <li><a href="#authentication">1. Authentication (12 controls)</a></li>
                        <li><a href="#authorization">2. Authorization (10 controls)</a></li>
                        <li><a href="#input-validation">3. Input Validation (14 controls)</a></li>
                        <li><a href="#rate-limiting">4. Rate Limiting (8 controls)</a></li>
                    </ul>
                </div>
                <div class="toc-column">
                    <ul class="toc-list">
                        <li><a href="#logging-monitoring">5. Logging & Monitoring (12 controls)</a></li>
                        <li><a href="#data-protection">6. Data Protection (9 controls)</a></li>
                        <li><a href="#api-gateway">7. API Gateway Security (5 controls)</a></li>
                        <li><a href="#graphql-security">8. GraphQL Security (4 controls)</a></li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Authentication Section (12 Controls) -->
        <section id="authentication" class="control-section">
            <h2>1. Authentication (12 Controls)</h2>
            <p class="section-intro">Strong authentication mechanisms are the foundation of API security. These controls establish user identity and ensure only authenticated entities can access your APIs.</p>

            <!-- Control 1.1 -->
            <div class="control-card">
                <div class="control-header">
                    <h3 class="control-title">1.1 Multi-Factor Authentication (MFA)</h3>
                    <div class="control-tags">
                        <span class="tag priority-critical">Critical</span>
                        <span class="tag difficulty-medium">Medium</span>
                    </div>
                </div>
                
                <div class="control-content">
                    <p class="control-description">Implement multi-factor authentication for all API access, especially for privileged operations and sensitive data access.</p>
                    
                    <div class="implementation">
                        <h4>üîß Implementation</h4>
                        <pre><code>// OAuth 2.0 with PKCE + TOTP Example
const auth = {
    // Step 1: PKCE Challenge
    codeVerifier: generateCodeVerifier(),
    codeChallenge: generateCodeChallenge(codeVerifier),
    
    // Step 2: Request authorization with MFA requirement
    authUrl: `https://auth.example.com/oauth/authorize?` +
             `client_id=${clientId}&` +
             `redirect_uri=${redirectUri}&` +
             `code_challenge=${codeChallenge}&` +
             `code_challenge_method=S256&` +
             `scope=api:read api:write&` +
             `acr_values=mfa`,  // Require MFA
    
    // Step 3: Exchange code for token (includes MFA verification)
    async exchangeToken(authCode) {
        const response = await fetch('/oauth/token', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                grant_type: 'authorization_code',
                client_id: clientId,
                code: authCode,
                redirect_uri: redirectUri,
                code_verifier: this.codeVerifier
            })
        });
        return response.json();
    }
};</code></pre>
                    </div>

                    <div class="validation">
                        <h4>‚úÖ Validation</h4>
                        <ul>
                            <li>Verify MFA challenge completion before token issuance</li>
                            <li>Check token includes MFA claim (amr: ["mfa", "totp"])</li>
                            <li>Test MFA bypass attempts return 401 Unauthorized</li>
                            <li>Validate MFA requirement for sensitive operations</li>
                        </ul>
                    </div>

                    <div class="best-practices">
                        <h4>üìã Best Practices</h4>
                        <ul>
                            <li>Support multiple MFA methods (TOTP, SMS, hardware keys)</li>
                            <li>Implement adaptive MFA based on risk factors</li>
                            <li>Provide MFA recovery mechanisms</li>
                            <li>Monitor and alert on MFA failures</li>
                        </ul>
                    </div>

                    <div class="security-notes">
                        <h4>üîí Security Notes</h4>
                        <ul>
                            <li>SMS-based MFA is vulnerable to SIM swapping</li>
                            <li>Consider WebAuthn/FIDO2 for passwordless MFA</li>
                            <li>Implement rate limiting on MFA attempts</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Control 1.2 -->
            <div class="control-card">
                <div class="control-header">
                    <h3 class="control-title">1.2 JWT Token Validation</h3>
                    <div class="control-tags">
                        <span class="tag priority-critical">Critical</span>
                        <span class="tag difficulty-high">High</span>
                    </div>
                </div>
                
                <div class="control-content">
                    <p class="control-description">Properly validate JSON Web Tokens including signature verification, expiration, and claims validation.</p>
                    
                    <div class="implementation">
                        <h4>üîß Implementation</h4>
                        <pre><code>const jwt = require('jsonwebtoken');
const jwksClient = require('jwks-rsa');

// JWKS client for key rotation
const client = jwksClient({
    jwksUri: 'https://auth.example.com/.well-known/jwks.json',
    cache: true,
    cacheMaxAge: 86400000, // 24 hours
    rateLimit: true,
    jwksRequestsPerMinute: 5
});

function getKey(header, callback) {
    client.getSigningKey(header.kid, (err, key) => {
        const signingKey = key.publicKey || key.rsaPublicKey;
        callback(null, signingKey);
    });
}

// Middleware for JWT validation
function validateJWT(req, res, next) {
    const token = req.headers.authorization?.replace('Bearer ', '');
    
    if (!token) {
        return res.status(401).json({ error: 'Missing token' });
    }

    jwt.verify(token, getKey, {
        audience: process.env.JWT_AUDIENCE,
        issuer: process.env.JWT_ISSUER,
        algorithms: ['RS256'],
        clockTolerance: 30, // 30 second clock skew tolerance
        maxAge: '1h' // Maximum token age
    }, (err, decoded) => {
        if (err) {
            return res.status(401).json({ 
                error: 'Invalid token',
                details: err.message 
            });
        }
        
        // Additional custom validations
        if (!decoded.sub || !decoded.scope) {
            return res.status(401).json({ error: 'Invalid token claims' });
        }
        
        req.user = decoded;
        next();
    });
}</code></pre>
                    </div>

                    <div class="validation">
                        <h4>‚úÖ Validation</h4>
                        <ul>
                            <li>Verify signature with correct public key</li>
                            <li>Check token expiration (exp claim)</li>
                            <li>Validate issuer (iss) and audience (aud) claims</li>
                            <li>Ensure algorithm is explicitly whitelisted</li>
                            <li>Test with tampered tokens to ensure rejection</li>
                        </ul>
                    </div>

                    <div class="best-practices">
                        <h4>üìã Best Practices</h4>
                        <ul>
                            <li>Use short-lived access tokens (15-60 minutes)</li>
                            <li>Implement token refresh mechanisms</li>
                            <li>Include necessary claims only (principle of least privilege)</li>
                            <li>Use secure key rotation practices</li>
                        </ul>
                    </div>

                    <div class="security-notes">
                        <h4>üîí Security Notes</h4>
                        <ul>
                            <li>Never accept "none" algorithm</li>
                            <li>Always validate the "alg" header parameter</li>
                            <li>Beware of key confusion attacks (RSA/HMAC)</li>
                            <li>Implement proper JWKS caching and rotation</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Control 1.3 -->
            <div class="control-card">
                <div class="control-header">
                    <h3 class="control-title">1.3 OAuth 2.0 PKCE Implementation</h3>
                    <div class="control-tags">
                        <span class="tag priority-high">High</span>
                        <span class="tag difficulty-medium">Medium</span>
                    </div>
                </div>
                
                <div class="control-content">
                    <p class="control-description">Implement Proof Key for Code Exchange (PKCE) to secure OAuth 2.0 authorization code flow against code interception attacks.</p>
                    
                    <div class="implementation">
                        <h4>üîß Implementation</h4>
                        <pre><code>// Client-side PKCE implementation
class PKCEAuth {
    constructor(clientId, redirectUri, authEndpoint, tokenEndpoint) {
        this.clientId = clientId;
        this.redirectUri = redirectUri;
        this.authEndpoint = authEndpoint;
        this.tokenEndpoint = tokenEndpoint;
    }

    // Generate code verifier (43-128 characters)
    generateCodeVerifier() {
        const array = new Uint8Array(32);
        crypto.getRandomValues(array);
        return btoa(String.fromCharCode(...array))
            .replace(/\+/g, '-')
            .replace(/\//g, '_')
            .replace(/=/g, '');
    }

    // Generate code challenge
    async generateCodeChallenge(verifier) {
        const encoder = new TextEncoder();
        const data = encoder.encode(verifier);
        const digest = await crypto.subtle.digest('SHA-256', data);
        return btoa(String.fromCharCode(...new Uint8Array(digest)))
            .replace(/\+/g, '-')
            .replace(/\//g, '_')
            .replace(/=/g, '');
    }

    // Start authorization flow
    async startAuth(scopes = ['read']) {
        this.codeVerifier = this.generateCodeVerifier();
        this.codeChallenge = await this.generateCodeChallenge(this.codeVerifier);
        this.state = crypto.randomUUID();

        const params = new URLSearchParams({
            response_type: 'code',
            client_id: this.clientId,
            redirect_uri: this.redirectUri,
            scope: scopes.join(' '),
            state: this.state,
            code_challenge: this.codeChallenge,
            code_challenge_method: 'S256'
        });

        window.location.href = `${this.authEndpoint}?${params}`;
    }

    // Exchange authorization code for tokens
    async exchangeCodeForTokens(code, state) {
        if (state !== this.state) {
            throw new Error('State mismatch - possible CSRF attack');
        }

        const response = await fetch(this.tokenEndpoint, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams({
                grant_type: 'authorization_code',
                client_id: this.clientId,
                code: code,
                redirect_uri: this.redirectUri,
                code_verifier: this.codeVerifier
            })
        });

        if (!response.ok) {
            throw new Error(`Token exchange failed: ${response.status}`);
        }

        return response.json();
    }
}</code></pre>
                    </div>

                    <div class="validation">
                        <h4>‚úÖ Validation</h4>
                        <ul>
                            <li>Verify code verifier matches code challenge</li>
                            <li>Ensure code challenge method is S256</li>
                            <li>Validate state parameter to prevent CSRF</li>
                            <li>Test with invalid code verifier to ensure rejection</li>
                        </ul>
                    </div>

                    <div class="best-practices">
                        <h4>üìã Best Practices</h4>
                        <ul>
                            <li>Always use S256 challenge method (not plain)</li>
                            <li>Generate cryptographically secure random values</li>
                            <li>Store code verifier securely on client</li>
                            <li>Implement proper error handling</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Control 1.4 -->
            <div class="control-card">
                <div class="control-header">
                    <h3 class="control-title">1.4 API Key Management</h3>
                    <div class="control-tags">
                        <span class="tag priority-high">High</span>
                        <span class="tag difficulty-low">Low</span>
                    </div>
                </div>
                
                <div class="control-content">
                    <p class="control-description">Implement secure API key generation, distribution, rotation, and revocation mechanisms.</p>
                    
                    <div class="implementation">
                        <h4>üîß Implementation</h4>
                        <pre><code>// API Key Management System
const crypto = require('crypto');

class APIKeyManager {
    constructor(database) {
        this.db = database;
        this.keyPrefix = 'ak_'; // API key prefix for identification
    }

    // Generate secure API key
    generateAPIKey() {
        const randomBytes = crypto.randomBytes(32);
        const apiKey = this.keyPrefix + randomBytes.toString('base64url');
        return apiKey;
    }

    // Create API key with metadata
    async createAPIKey(userId, scopes, expiresIn = '1y') {
        const apiKey = this.generateAPIKey();
        const hashedKey = crypto.createHash('sha256').update(apiKey).digest('hex');
        
        const keyData = {
            id: crypto.randomUUID(),
            user_id: userId,
            key_hash: hashedKey,
            scopes: scopes,
            created_at: new Date(),
            expires_at: new Date(Date.now() + this.parseExpiry(expiresIn)),
            last_used: null,
            is_active: true
        };

        await this.db.apiKeys.insert(keyData);
        
        // Return the plain key only once
        return {
            id: keyData.id,
            key: apiKey, // Only returned during creation
            scopes: keyData.scopes,
            expires_at: keyData.expires_at
        };
    }

    // Validate API key
    async validateAPIKey(apiKey) {
        if (!apiKey || !apiKey.startsWith(this.keyPrefix)) {
            return null;
        }

        const hashedKey = crypto.createHash('sha256').update(apiKey).digest('hex');
        
        const keyRecord = await this.db.apiKeys.findOne({
            key_hash: hashedKey,
            is_active: true,
            expires_at: { $gt: new Date() }
        });

        if (keyRecord) {
            // Update last used timestamp
            await this.db.apiKeys.updateOne(
                { id: keyRecord.id },
                { $set: { last_used: new Date() } }
            );
        }

        return keyRecord;
    }

    // Middleware for API key authentication
    middleware() {
        return async (req, res, next) => {
            const apiKey = req.headers['x-api-key'] || 
                          req.headers['authorization']?.replace('Bearer ', '');

            if (!apiKey) {
                return res.status(401).json({ error: 'API key required' });
            }

            const keyRecord = await this.validateAPIKey(apiKey);
            
            if (!keyRecord) {
                return res.status(401).json({ error: 'Invalid API key' });
            }

            req.apiKey = keyRecord;
            req.user = { id: keyRecord.user_id };
            next();
        };
    }
}</code></pre>
                    </div>

                    <div class="validation">
                        <h4>‚úÖ Validation</h4>
                        <ul>
                            <li>Test API key validation with valid/invalid keys</li>
                            <li>Verify expired keys are rejected</li>
                            <li>Check revoked keys cannot be used</li>
                            <li>Validate scope-based access control</li>
                        </ul>
                    </div>

                    <div class="best-practices">
                        <h4>üìã Best Practices</h4>
                        <ul>
                            <li>Use cryptographically secure random generation</li>
                            <li>Store hashed versions, never plaintext</li>
                            <li>Implement key rotation policies</li>
                            <li>Add metadata (creation time, last used, scope)</li>
                            <li>Use prefixes for key identification</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Authorization Section (10 Controls) -->
        <section id="authorization" class="control-section">
            <h2>2. Authorization (10 Controls)</h2>
            <p class="section-intro">Authorization controls ensure that authenticated users can only access resources and perform actions they are explicitly permitted to. These controls implement fine-grained access control policies.</p>

            <!-- Control 2.1 -->
            <div class="control-card">
                <div class="control-header">
                    <h3 class="control-title">2.1 Role-Based Access Control (RBAC)</h3>
                    <div class="control-tags">
                        <span class="tag priority-critical">Critical</span>
                        <span class="tag difficulty-medium">Medium</span>
                    </div>
                </div>
                
                <div class="control-content">
                    <p class="control-description">Implement comprehensive role-based access control with hierarchical roles and permission inheritance.</p>
                    
                    <div class="implementation">
                        <h4>üîß Implementation</h4>
                        <pre><code>// RBAC System Implementation
class RBACManager {
    constructor(database) {
        this.db = database;
    }

    // Define role hierarchy and permissions
    async initializeRoles() {
        const roles = [
            {
                name: 'admin',
                permissions: ['*'], // All permissions
                inherits: []
            },
            {
                name: 'manager',
                permissions: ['read:all', 'write:own', 'delete:own'],
                inherits: ['user']
            },
            {
                name: 'user',
                permissions: ['read:own', 'write:own'],
                inherits: []
            },
            {
                name: 'viewer',
                permissions: ['read:own'],
                inherits: []
            }
        ];

        for (const role of roles) {
            await this.db.roles.upsert({ name: role.name }, role);
        }
    }

    // Check if user has specific permission
    async hasPermission(userId, permission, resource = null) {
        const userPermissions = await this.getUserPermissions(userId);
        
        // Check for wildcard permission
        if (userPermissions.includes('*')) return true;
        
        // Check for exact permission match
        if (userPermissions.includes(permission)) return true;
        
        // Check for resource-specific permissions
        if (resource) {
            const resourcePermission = `${permission}:${resource}`;
            if (userPermissions.includes(resourcePermission)) return true;
        }

        return false;
    }

    // Middleware for route protection
    requirePermission(permission) {
        return async (req, res, next) => {
            const userId = req.user?.id;
            if (!userId) {
                return res.status(401).json({ error: 'Authentication required' });
            }

            const hasAccess = await this.hasPermission(userId, permission);
            if (!hasAccess) {
                return res.status(403).json({ 
                    error: 'Insufficient permissions',
                    required: permission 
                });
            }

            next();
        };
    }
}</code></pre>
                    </div>

                    <div class="validation">
                        <h4>‚úÖ Validation</h4>
                        <ul>
                            <li>Test permission inheritance works correctly</li>
                            <li>Verify users cannot access unauthorized resources</li>
                            <li>Check role assignment and revocation</li>
                            <li>Test circular inheritance detection</li>
                        </ul>
                    </div>

                    <div class="best-practices">
                        <h4>üìã Best Practices</h4>
                        <ul>
                            <li>Follow principle of least privilege</li>
                            <li>Use descriptive permission names</li>
                            <li>Implement role hierarchies carefully</li>
                            <li>Regular access reviews and cleanup</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Control 2.2 -->
            <div class="control-card">
                <div class="control-header">
                    <h3 class="control-title">2.2 Attribute-Based Access Control (ABAC)</h3>
                    <div class="control-tags">
                        <span class="tag priority-high">High</span>
                        <span class="tag difficulty-high">High</span>
                    </div>
                </div>
                
                <div class="control-content">
                    <p class="control-description">Implement fine-grained attribute-based access control using policies that evaluate user, resource, and environmental attributes.</p>
                    
                    <div class="implementation">
                        <h4>üîß Implementation</h4>
                        <pre><code>// ABAC Policy Engine
class ABACEngine {
    constructor() {
        this.policies = new Map();
    }

    // Define ABAC policy
    addPolicy(name, policy) {
        this.policies.set(name, {
            ...policy,
            evaluate: this.compilePolicy(policy.rules)
        });
    }

    // Evaluate access request
    async authorize(context) {
        const results = [];
        
        for (const [name, policy] of this.policies) {
            const result = {
                policy: name,
                effect: policy.effect,
                decision: policy.evaluate(context)
            };
            results.push(result);
        }

        // Policy combination logic
        return this.combineDecisions(results);
    }

    // Combine policy decisions
    combineDecisions(results) {
        // Deny overrides - any explicit deny blocks access
        const denyResults = results.filter(r => r.effect === 'deny' && r.decision);
        if (denyResults.length > 0) {
            return { decision: 'deny', reason: 'Explicit deny policy matched' };
        }

        // Permit if any allow policy matches
        const permitResults = results.filter(r => r.effect === 'allow' && r.decision);
        if (permitResults.length > 0) {
            return { decision: 'allow', reason: 'Allow policy matched' };
        }

        return { decision: 'deny', reason: 'No matching allow policy' };
    }
}</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Remaining Sections Summary -->
        <section class="remaining-sections">
            <h2>Remaining Sections</h2>
            <p class="section-intro">The complete guide includes 52 additional controls across 6 more sections:</p>
            
            <div class="section-preview">
                <div class="preview-card">
                    <h3>3. Input Validation (14 controls)</h3>
                    <p>SQL injection, XSS, parameter tampering, file upload security, and schema validation</p>
                    <ul class="preview-controls">
                        <li>SQL Injection Prevention</li>
                        <li>XSS Protection</li>
                        <li>Parameter Validation</li>
                        <li>File Upload Security</li>
                        <li>Schema Validation</li>
                    </ul>
                </div>

                <div class="preview-card">
                    <h3>4. Rate Limiting (8 controls)</h3>
                    <p>Request throttling, DDoS protection, and adaptive rate limiting strategies</p>
                    <ul class="preview-controls">
                        <li>Token Bucket Algorithm</li>
                        <li>Sliding Window</li>
                        <li>IP-based Limiting</li>
                        <li>User-based Limiting</li>
                    </ul>
                </div>

                <div class="preview-card">
                    <h3>5. Logging & Monitoring (12 controls)</h3>
                    <p>Security logging, SIEM integration, anomaly detection, and incident response</p>
                    <ul class="preview-controls">
                        <li>Security Event Logging</li>
                        <li>Anomaly Detection</li>
                        <li>SIEM Integration</li>
                        <li>Real-time Alerting</li>
                    </ul>
                </div>

                <div class="preview-card">
                    <h3>6. Data Protection (9 controls)</h3>
                    <p>Encryption, data masking, PII protection, and secure data transmission</p>
                    <ul class="preview-controls">
                        <li>End-to-End Encryption</li>
                        <li>Data Masking</li>
                        <li>PII Protection</li>
                        <li>Secure Transmission</li>
                    </ul>
                </div>

                <div class="preview-card">
                    <h3>7. API Gateway Security (5 controls)</h3>
                    <p>Gateway hardening, load balancing, and centralized security policies</p>
                    <ul class="preview-controls">
                        <li>Gateway Hardening</li>
                        <li>Policy Enforcement</li>
                        <li>Load Balancing</li>
                    </ul>
                </div>

                <div class="preview-card">
                    <h3>8. GraphQL Security (4 controls)</h3>
                    <p>Query complexity analysis, depth limiting, and GraphQL-specific attacks</p>
                    <ul class="preview-controls">
                        <li>Query Complexity</li>
                        <li>Depth Limiting</li>
                        <li>Introspection Control</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Control Summary -->
        <section class="control-summary">
            <h2>API Security Control Summary</h2>
            <div class="summary-grid">
                <div class="summary-item">
                    <strong>Total Controls:</strong> 74 comprehensive security controls
                </div>
                <div class="summary-item">
                    <strong>Coverage:</strong> REST APIs, GraphQL, gRPC, and WebSocket security
                </div>
                <div class="summary-item">
                    <strong>Implementation:</strong> Production-ready code examples and testing guides
                </div>
                <div class="summary-item">
                    <strong>Compliance:</strong> OWASP API Security Top 10, NIST, and industry standards
                </div>
            </div>
        </section>

        <!-- Guide Footer -->
        <section class="guide-footer">
            <h3>Continue Your Security Journey</h3>
            <p>Explore related security guides and deepen your cybersecurity knowledge</p>
            <div class="footer-nav">
                <a href="../guides/iam.html" class="btn btn-outline">Identity & Access Management ‚Üí</a>
                <a href="../guides/cloud-security.html" class="btn btn-outline">Cloud Security ‚Üí</a>
                <a href="../topics.html" class="btn btn-primary">View All Topics</a>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>üõ°Ô∏è Iron Codex</h3>
                    <p>Practical cybersecurity guidance for security professionals.</p>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="../topics.html">All Topics</a></li>
                        <li><a href="../guides.html">Deep Dive Guides</a></li>
                        <li><a href="../tools.html">Security Tools</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Community</h4>
                    <ul>
                        <li><a href="https://github.com/iron-codex">GitHub</a></li>
                        <li><a href="mailto:contact@iron-codex.com">Contact</a></li>
                        <li><a href="../about.html">About</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Iron Codex. Open source cybersecurity education.</p>
            </div>
        </div>
    </footer>

    <script src="../assets/js/main.js"></script>
    <style>
        /* Guide-specific styles */
        .guide-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 0;
        }

        .guide-header {
            margin-bottom: 3rem;
        }

        .breadcrumb {
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--accent);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .guide-header h1 {
            color: var(--accent);
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .guide-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .meta-item {
            color: var(--text-muted);
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
            background: var(--glass);
            border-radius: 20px;
            border: 1px solid var(--border);
        }

        .guide-intro {
            color: var(--text-muted);
            font-size: 1.2rem;
            line-height: 1.6;
        }

        .toc-section {
            margin-bottom: 3rem;
        }

        .toc-section h2 {
            color: var(--accent);
            font-size: 2rem;
            margin-bottom: 1.5rem;
        }

        .toc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list li {
            margin-bottom: 0.5rem;
        }

        .toc-list a {
            color: var(--text);
            text-decoration: none;
            padding: 0.5rem;
            display: block;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .toc-list a:hover {
            background: var(--glass);
            color: var(--accent);
        }

        .control-section {
            margin-bottom: 4rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .control-section h2 {
            color: var(--accent);
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .section-intro {
            color: var(--text-muted);
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .control-card {
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .control-header {
            margin-bottom: 1.5rem;
        }

        .control-title {
            color: var(--accent);
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }

        .control-tags {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .tag {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .priority-critical {
            background: rgba(255, 71, 87, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .priority-high {
            background: rgba(255, 167, 38, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .difficulty-low {
            background: rgba(46, 213, 115, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .difficulty-medium {
            background: rgba(255, 167, 38, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .difficulty-high {
            background: rgba(255, 71, 87, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .control-description {
            color: var(--text-muted);
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }

        .implementation,
        .validation,
        .best-practices,
        .security-notes {
            margin: 1.5rem 0;
        }

        .implementation h4,
        .validation h4,
        .best-practices h4,
        .security-notes h4 {
            color: var(--success);
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        pre {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        code {
            color: var(--accent);
            font-family: 'Courier New', monospace;
        }

        .remaining-sections {
            margin: 4rem 0;
        }

        .section-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .preview-card {
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
        }

        .preview-card h3 {
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .preview-controls {
            list-style: none;
            margin-top: 1rem;
        }

        .preview-controls li {
            color: var(--text-muted);
            padding: 0.3rem 0;
            font-size: 0.9rem;
        }

        .control-summary {
            background: rgba(0, 212, 255, 0.05);
            border: 1px solid var(--accent);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .summary-item {
            background: var(--glass);
            padding: 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .guide-footer {
            text-align: center;
            padding: 3rem 0;
            margin-top: 4rem;
            border-top: 2px solid var(--border);
        }

        .footer-nav {
            display: flex;
            gap: 2rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .guide-header h1 {
                font-size: 2rem;
            }
            
            .guide-meta {
                flex-direction: column;
                gap: 1rem;
            }
            
            .toc-grid,
            .summary-grid,
            .section-preview {
                grid-template-columns: 1fr;
            }
            
            .footer-nav {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</body>
</html>